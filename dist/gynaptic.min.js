/*!
 * The MIT License (MIT)
 * 
 * Copyright 2017 Thomas Wagenaar
 * 
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 * 
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 * 
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
 * THE SOFTWARE
 * 
 */
!function(n){function t(i){if(o[i])return o[i].exports;var e=o[i]={i:i,l:!1,exports:{}};return n[i].call(e.exports,e,e.exports,t),e.l=!0,e.exports}var o={};t.m=n,t.c=o,t.i=function(n){return n},t.d=function(n,o,i){t.o(n,o)||Object.defineProperty(n,o,{configurable:!1,enumerable:!0,get:i})},t.n=function(n){var o=n&&n.__esModule?function(){return n.default}:function(){return n};return t.d(o,"a",o),o},t.o=function(n,t){return Object.prototype.hasOwnProperty.call(n,t)},t.p="",t(t.s=10)}([function(n,t){n.exports=function(n){return n.webpackPolyfill||(n.deprecate=function(){},n.paths=[],n.children||(n.children=[]),Object.defineProperty(n,"loaded",{enumerable:!0,get:function(){return n.l}}),Object.defineProperty(n,"id",{enumerable:!0,get:function(){return n.i}}),n.webpackPolyfill=1),n}},function(n,t,o){var i,e,s={Activation:o(4),Mutation:o(8),Selection:o(9),Crossover:o(7)};i=[],void 0!==(e=function(){return s}.apply(t,i))&&(n.exports=e),void 0!==n&&n.exports&&(n.exports=s),"object"==typeof window&&(!function(){var n=window.methods;s.ninja=function(){return window.methods=n,s}}(),window.methods=s)},function(n,t,o){(function(n){function t(n,t){this.bias="input"==n?0:.2*Math.random()-.1,this.squash=e.LOGISTIC,this.type=n||"hidden",void 0!==t&&(this.ID=t),this.activation=0,this.connections={in:[],out:[]},this.error={responsibility:0,projected:0},this.trace={elegibility:{}}}n&&(n.exports=t);var i=o(1),e=i.Activation,s=i.Mutation;t.prototype={activate:function(n){if("input"==this.type)return this.activation=n,this.activation;this.state=this.bias;for(t in this.connections.in)this.state+=this.connections.in[t].from.activation*this.connections.in[t].weight;this.activation=this.squash(this.state),this.derivative=this.squash(this.state,!0);for(var t in this.connections.in){var n=this.connections.in[t];this.trace.elegibility[t]=n.from.activation}return this.activation},propagate:function(n,t){var o=0;if("output"==this.type)this.error.responsibility=this.error.projected=t-this.activation;else{for(var i in this.connections.out){var i=this.connections.out[i];o+=i.to.error.responsibility*i.weight}this.error.projected=this.derivative*o,this.error.responsibility=this.error.projected}n=n||.1;for(var i in this.connections.in){var e=this.connections.in[i],s=this.error.projected*this.trace.elegibility[i];e.weight+=n*s}this.bias+=n*this.error.responsibility},mutate:function(n){if(void 0===n)throw new Error("No mutate method given");switch(n){case s.MOD_ACTIVATION:for(var t=Math.floor(Math.random()*s.MOD_ACTIVATION.config.allowed.length);s.MOD_ACTIVATION.config.allowed[t]==this.squash;)t=Math.floor(Math.random()*s.MOD_ACTIVATION.config.allowed.length);this.squash=s.MOD_ACTIVATION.config.allowed[t]}},isProjectingTo:function(n){for(conn in this.connections.out)if(conn=this.connections.out[conn],conn.to==n)return!0;return!1},isProjectedBy:function(n){for(conn in this.connections.in)if(conn=this.connections.in[conn],conn.from==n)return!0;return!1},toJSON:function(){return{ID:this.ID,bias:this.bias,type:this.type,squash:this.squash.name}}},t.fromJSON=function(n){var o=new t;o.ID=n.ID,o.bias=n.bias,o.type=n.type;for(squash in e)if(e[squash].name==n.squash){o.squash=e[squash];break}return o}}).call(t,o(0)(n))},function(n,t,o){(function(n){function t(n,t){if(void 0===n||void 0===t)throw new Error("No input or output size given");this.input=n,this.output=t,this.nodes=[],this.connections=[];for(var o=0;o<this.input+this.output;o++){var e=o<this.input?"input":"output";this.nodes.push(new i(e,this.nodes.length))}for(var o=0;o<this.input;o++)for(var s=this.input;s<this.output+this.input;s++)this.connect(this.nodes[o],this.nodes[s])}n&&(n.exports=t);var i=o(2),e=o(6),s=o(1),r=s.Activation,c=s.Mutation;t.prototype={activate:function(n){var t=[];for(node in this.nodes)switch(this.nodes[node].type){case"input":this.nodes[node].activate(n[node]);break;case"hidden":this.nodes[node].activate();break;case"output":var o=this.nodes[node].activate();t.push(o)}return t},propagate:function(n,t){this.nodes.reverse();for(node in this.nodes)switch(this.nodes[node].type){case"hidden":this.nodes[node].propagate(n);break;case"output":this.nodes[node].propagate(n,t[node])}this.nodes.reverse()},connect:function(n,t){var o=new e(n,t);return this.connections.push(o),o.to.connections.in.push(o),o.from.connections.out.push(o),o},disconnect:function(n,t){for(conn in this.connections)if(this.connections[conn].from==n&&this.connections[conn].to==t){this.connections.splice(conn,1);break}for(conn in t.connections.in)if(t.connections.in[conn].from==n){t.connections.in.splice(conn,1);break}for(conn in n.connections.out)if(n.connections.out[conn].to==t){n.connections.out.splice(conn,1);break}},mutate:function(n){if(void 0===n)throw new Error("No mutate method given");switch(n){case c.ADD_NODE:console.log("node added");var t=this.connections[Math.floor(Math.random()*this.connections.length)];this.disconnect(t.from,t.to);var o=this.nodes.indexOf(t.to),e=new i("hidden",this.nodes.length);e.mutate(c.MOD_ACTIVATION);var s=Math.min(o,this.nodes.length-this.output);this.nodes.splice(s,0,e),this.connect(t.from,e),this.connect(e,t.to);break;case c.REMOVE_NODE:if(this.nodes.length==this.input+this.output){console.warn("No more nodes left to remove!");break}for(var r=Math.floor(Math.random()*(this.nodes.length-this.output-this.input)+this.input),e=this.nodes[r],a=[],h=e.connections.in.length-1;h>=0;h--){var u=e.connections.in[h].from;a.push(u),this.disconnect(u,e)}for(var f=[],h=e.connections.out.length-1;h>=0;h--){var d=e.connections.out[h].to;f.push(d),this.disconnect(e,d)}for(var u in a){u=a[u];for(var d in f)d=f[d],u.isProjectingTo(d)||this.connect(u,d)}this.nodes.splice(r,1);break;case c.ADD_CONN:for(var p=0,l=0;l<this.nodes.length;l++)"input"==this.nodes[l].type?p+=this.nodes.length-this.input:"hidden"==this.nodes[l].type&&(p+=this.nodes.length-(l+1));if(p==this.connections.length){console.warn("Maximum amount of connections reached!");break}for(var v=!0;v;){v=!1;var O=Math.floor(Math.random()*(this.nodes.length-this.output)),m=this.nodes[O],s=Math.max(O+1,this.input),I=this.nodes[Math.floor(Math.random()*(this.nodes.length-s)+s)];for(h in this.connections)if(this.connections[h].from==m&&this.connections[h].to==I){v=!0;break}}this.connect(m,I);break;case c.MOD_WEIGHT:var t=this.connections[Math.floor(Math.random()*this.connections.length)],N=Math.random()*(c.MOD_WEIGHT.config.max-c.MOD_WEIGHT.config.min)+c.MOD_WEIGHT.config.min;t.weight+=N;break;case c.MOD_BIAS:var r=Math.floor(Math.random()*(this.nodes.length-this.input)+this.input),e=this.nodes[r],N=Math.random()*(c.MOD_BIAS.config.max-c.MOD_BIAS.config.min)+c.MOD_BIAS.config.min;e.bias+=N}},graph:function(){var n=0,t=0,o={nodes:[],links:[],constraints:[{type:"alignment",axis:"x",offsets:[]},{type:"alignment",axis:"y",offsets:[]}]};for(index in this.nodes){var i=this.nodes[index],e="input"==i.type?0:"output"==i.type?1:i.squash==r.LOGISTIC?2:i.squash==r.TANH?3:i.squash==r.IDENTITY?4:i.squash==r.HLIM?5:i.squash==r.RELU?6:i.squash==r.SOFTSIGN?7:i.squash==r.SINUSOID?8:i.squash==r.GAUSSIAN?9:null;0==e?(o.constraints[0].offsets.push({node:index,offset:600/this.input*n}),o.constraints[1].offsets.push({node:index,offset:0}),n++):1==e&&(o.constraints[0].offsets.push({node:index,offset:600/this.output*t}),o.constraints[1].offsets.push({node:index,offset:-200}),t++),o.nodes.push({id:index,type:e})}for(connection in this.connections)connection=this.connections[connection],o.links.push({source:this.nodes.indexOf(connection.from),target:this.nodes.indexOf(connection.to),weight:connection.weight});return o},toJSON:function(){var n={nodes:[],connections:[],input:this.input,output:this.output};for(index in this.nodes){var t=this.nodes[index].toJSON();t.index=index,n.nodes.push(t)}for(o in this.connections){var o=this.connections[o],i=o.toJSON();i.from=this.nodes.indexOf(o.from),i.to=this.nodes.indexOf(o.to),n.connections.push(i)}return n}},t.fromJSON=function(n){var o=new t(n.input,n.output);o.nodes=[],o.connections=[];for(node in n.nodes)o.nodes.push(i.fromJSON(n.nodes[node]));for(e in n.connections){var e=n.connections[e],s=o.connect(o.nodes[e.from],o.nodes[e.to]);s.weight=e.weight,s.ID=e.id}return o},t.crossOver=function(n,o,i){if(void 0===i)throw new Error("No crossover method given");var e=new t(n.input,n.output);if(e.connections=[],e.nodes=[],n.score>o.score)var s=t.fromJSON(n.toJSON()),r=t.fromJSON(o.toJSON());else var s=t.fromJSON(o.toJSON()),r=t.fromJSON(n.toJSON());var c={},a={};for(conn in s.connections)conn=s.connections[conn],c[conn.ID]=conn;for(conn in r.connections)conn=r.connections[conn],a[conn.ID]=conn;for(conn in c)Object.keys(a).includes(conn)?Math.random()>=.5?e.connections.push(c[conn]):e.connections.push(a[conn]):e.connections.push(c[conn]);var h=[];for(node in r.nodes)h.push(r.nodes[node].ID);for(node in s.nodes)if(node=s.nodes[node],h.includes(node.ID))if(Math.random()>=.5)e.nodes.push(node);else{var u=h.indexOf(node.ID);e.nodes.push(r.nodes[u])}else e.nodes.push(node);var f=[];for(node in e.nodes)node=e.nodes[node],node.connections={in:[],out:[]},f.push(node.ID);for(conn in e.connections){conn=e.connections[conn];var d=e.nodes[f.indexOf(conn.from.ID)],p=e.nodes[f.indexOf(conn.to.ID)];conn.from=d,conn.to=p,d.connections.out.push(conn),p.connections.in.push(conn)}return console.log(e),e}}).call(t,o(0)(n))},function(n,t,o){(function(n){var t={LOGISTIC:function(n,o){if(!o)return 1/(1+Math.exp(-n));var i=t.LOGISTIC(n);return i*(1-i)},TANH:function(n,o){return o?1-Math.pow(t.TANH(n),2):Math.tanh(n)},IDENTITY:function(n,t){return t?1:n},HLIM:function(n,t){return t?1:n>0?1:0},RELU:function(n,t){return t?n>0?1:0:n>0?n:0},SOFTSIGN:function(n,t){var o=1+Math.abs(n);return t?n/Math.pow(o,2):n/o},SINUSOID:function(n,t){return t?Math.cos(n):Math.sin(n)},GAUSSIAN:function(n,t){var o=Math.exp(-Math.pow(n,2));return t?-2*n*o:o}};n&&(n.exports=t)}).call(t,o(0)(n))},function(n,t,o){(function(n){function t(n,t,o,i){this.input=n,this.output=t,this.fitness=o,this.popsize=i.popsize||50,this.elitism=i.elitism||0,this.mutation=i.mutation||[s.ADD_NODE,s.ADD_CONN],this.selection=i.selection||[r.FITNESS_PROPORTIONATE],this.crossover=i.crossover||[c.UNIFORM],this.mutationRate=i.mutationRate||.3,this.generation=0,this.createPool()}n&&(n.exports=t);var i=(o(2),o(3)),e=o(1),s=(e.Activation,e.Mutation),r=e.Selection,c=e.Crossover;t.prototype={createPool:function(){this.population=[];for(var n=new i(this.input,this.output),t=0;t<this.popsize;t++){var o=i.fromJSON(n.toJSON());this.population.push(o)}},evolve:function(){for(genome in this.population){var n=this.fitness(this.population[genome]);this.population[genome].score=n}this.population.sort(function(n,t){return n.score-t.score});for(var t=[],o=0;o<this.elitism;o++)t.push(this.population[o]);for(var o=0;o<this.popsize-this.elitism;o++){var e=this.getParent(),s=this.getParent(),r=this.crossover[Math.floor(Math.random()*this.crossover.length)],c=i.crossOver(e,s,r);t.push(c)}for(genome in t)if(Math.random()<=this.mutationRate){var a=this.mutation[Math.floor(Math.random()*this.mutation.length)];t[genome].mutate(a)}this.population=t,this.generation++},getParent:function(){switch(this.selection[Math.floor(Math.random()*this.selection.length)]){case r.FITNESS_PROPORTIONATE:var n=Math.floor(r.FITNESS_PROPORTIONATE.config(Math.random())*this.popsize);return this.population[n]}}}}).call(t,o(0)(n))},function(n,t,o){(function(n){function t(n,o){this.weight=.2*Math.random()-.1,this.from=n,this.to=o,this.ID=t.innovationUID()}n&&(n.exports=t),t.prototype={toJSON:function(){return{weight:this.weight,id:this.ID}}},function(){var n=0;t.innovationUID=function(){return n++}}()}).call(t,o(0)(n))},function(n,t,o){(function(n){var t={SINGLE_POINT:{name:"SINGLE_POINT",config:[.4]},TWO_POINT:{name:"TWO_POINT",config:[.4,.9]},UNIFORM:{name:"UNIFORM"},AVERAGE:{name:"AVERAGE"}};n&&(n.exports=t)}).call(t,o(0)(n))},function(n,t,o){(function(n){var t=o(4),i={ADD_NODE:{name:"ADD_NODE"},REMOVE_NODE:{name:"REMOVE_NODE"},ADD_CONN:{name:"ADD_CONNECTION"},REMOVE_CONN:{name:"REMOVE_CONN"},MOD_WEIGHT:{name:"MOD_WEIGHT",config:{min:-1,max:1}},MOD_BIAS:{name:"MOD_BIAS",config:{min:-1,max:1}},MOD_ACTIVATION:{name:"MOD_ACTIVATION",config:{allowed:[t.LOGISTIC,t.TANH,t.RELU,t.IDENTITY,t.HLIM,t.SOFTSIGN,t.SINUSOID,t.GAUSSIAN]}}};n&&(n.exports=i)}).call(t,o(0)(n))},function(n,t,o){(function(n){var t={FITNESS_PROPORTIONATE:{name:"FITNESS_PROPORTIONATE",config:function(n){return Math.pow(n,2)}}};n&&(n.exports=t)}).call(t,o(0)(n))},function(n,t,o){var i,e,s={Node:o(2),Neat:o(5),Network:o(3),Methods:o(1)};i=[],void 0!==(e=function(){return s}.apply(t,i))&&(n.exports=e),void 0!==n&&n.exports&&(n.exports=s),"object"==typeof window&&(!function(){var n=window.gynaptic;s.ninja=function(){return window.gynaptic=n,s}}(),window.gynaptic=s)}]);